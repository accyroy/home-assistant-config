# test test test
homeassistant:
  # Name of the location where Home Assistant is running
  name: !secret homeassistant_name
  # Location required to calculate the time the sun rises and sets
  latitude: !secret homeassistant_lat
  longitude: !secret homeassistant_lon
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: !secret homeassistant_elevation
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/London
  customize:
    #Fibaro Motion Node 4 Office
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_4_0:
      hidden: false
      friendly_name: Office PIR
      sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_4_0:
      hidden: true      
    sensor.fibaro_system_fgms001_motion_sensor_luminance_4_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_4_1:
      hidden: false
      friendly_name: Office Temp
    #Fibaro Motion Node 5 Ninas Room
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_5_0:
     hidden: false
     friendly_name: Ninas Room PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_5_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_5_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_5_1:
      hidden: false      
      friendly_name: Ninas Room Temp
     
    #Fibaro Motion Node 6 Kitchen
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_6_0:
     hidden: false
     friendly_name: Kitchen PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_6_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_6_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_6_1:
      hidden: false      
      friendly_name: Kitchen Temp     
      
    #Fibaro Motion Node 7 Roys Room
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_7_0:
     hidden: false
     friendly_name: Roys Room PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_7_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_7_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_7_1:
      hidden: false      
      friendly_name: Roys Room Temp      
 
    #Fibaro Motion Node 8 Bathroom
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_8_0:
     hidden: false
     friendly_name: Bathroom PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_8_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_8_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_8_1:
      hidden: false      
      friendly_name: Bathroom Temp
      
    #Fibaro Motion Node 11 Living Room
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_11_0:
     hidden: false
     friendly_name: Living Room PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_11_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_11_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_11_1:
      hidden: false      
      friendly_name: Living Room Temp      

    #Fibaro Motion Node 12 Conservatory
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_12_0:
     hidden: false
     friendly_name: Conservatory PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_12_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_12_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_12_1:
      hidden: false      
      friendly_name: Conservatory Temp

    #Fibaro Motion Node 13 Front Drive
    binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_13_0:
     hidden: false
     friendly_name: Front Drive PIR
     sensor_class: motion
    sensor.fibaro_system_fgms001_motion_sensor_general_13_0:
      hidden: true    
    sensor.fibaro_system_fgms001_motion_sensor_luminance_13_3:
      hidden: true
    sensor.fibaro_system_fgms001_motion_sensor_temperature_13_1:
      hidden: false      
      friendly_name: Front Drive Temp

 
    #Fibaro Dimmer Node 9 Living Room Main Lights
    light.fibaro_system_fgd212_dimmer_2_level_9_0:
      hidden: false
      friendly_name: Living Room Lights
    light.fibaro_system_fgd212_dimmer_2_level_9_0_2:
      hidden: true
    light.fibaro_system_fgd212_dimmer_2_step_size_9_6:
      hidden: true
    light.fibaro_system_fgd212_dimmer_2_step_size_9_6_2:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_alarm_level_9_1:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_alarm_type_9_0:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_energy_9_0:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_exporting_9_32:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_heat_9_7:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_9_4:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_9_8:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_management_9_11:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_sourcenodeid_9_2:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_system_9_12:
      hidden: true
 
    #Fibaro Dimmer Node 14 Entrance Lights
    light.fibaro_system_fgd212_dimmer_2_level_14_0:
      hidden: false
      friendly_name: Entrance Lights
    light.fibaro_system_fgd212_dimmer_2_level_14_0_2:
      hidden: true
    light.fibaro_system_fgd212_dimmer_2_step_size_14_6:
      hidden: true
    light.fibaro_system_fgd212_dimmer_2_step_size_14_6_2:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_alarm_level_14_1:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_alarm_type_14_0:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_energy_14_0:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_exporting_14_32:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_heat_14_7:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_14_4:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_14_8:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_power_management_14_11:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_sourcenodeid_14_2:
      hidden: true
    sensor.fibaro_system_fgd212_dimmer_2_system_14_12:
      hidden: true 
 
    #Fibaro RGBW Node 15 Living Room Screen Surround
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0:
      hidden: true
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0_2:
      hidden: false
      friendly_name: Cinema Surround
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0_3:    
      hidden: true
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0_4:
      hidden: true
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0_5:
      hidden: true
    light.fibaro_system_fgrgbwm441_rgbw_controller_level_15_0_6:
      hidden: true
    
    
    switch.everspring_se812_siren_switch_10_0:     
      hidden: false  
      friendly_name: Siren
    
    sensor.greenwave_powernode_1_port_energy_2_0:
      hidden: true
    sensor.greenwave_powernode_1_port_power_2_8:
      Hidden: false
      friendly_name: Clock Power
    sensor.greenwave_powernode_1_port_previous_reading_2_1:
      hidden: true
    sensor.greenwave_powernode_1_port_previous_reading_2_9:
      hidden: true
    switch.greenwave_powernode_1_port_switch_2_0:
      hidden: false
      friendly_name: Clock Monitor
    
    
# Show links to resources in log and frontend
#introduction:

# Enables the frontend
frontend:

http:
  # Uncomment this to add a password (recommended!)
  api_password: !secret http_api_password
  server_port: !secret http_server_port
  ssl_certificate: !secret http_ssl_certificate
  ssl_key: !secret http_ssl_key 

group:
  livingroom:
    name: Living Room
    view: yes
    entities:
      - light.fibaro_system_fgd212_dimmer_2_level_9_0
      
  office:
    name: Office
    view: yes
    entities:
      - sensor.fibaro_system_fgms001_motion_sensor_temperature_4_1
      - binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_4_0
      - sensor.greenwave_powernode_1_port_power_2_8
      - switch.greenwave_powernode_1_port_switch_2_0
      - light.office
      - light.office_desk_lamp

  ninasroom:
    name: Ninas Room
    view: yes
    entities:
      - light.ninas_room
      - media_player.ninas_room
      - binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_5_0
      - sensor.fibaro_system_fgms001_motion_sensor_temperature_5_1
      
  roysroom:
    name: Roys Room
    view: yes
    entities:
      - light.roys_room
      - media_player.roys_bedroom
      - sensor.fibaro_system_fgms001_motion_sensor_temperature_7_1
      - binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_7_0      

  kitchen:
    name: Kitchen
    view: yes
    entities:
      - light.kitchen
      - sensor.fibaro_system_fgms001_motion_sensor_temperature_6_1
      - binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_6_0

  bathroom:
    name: Bathroom
    view: yes
    entities:
      - sensor.fibaro_system_fgms001_motion_sensor_temperature_8_1
      - binary_sensor.fibaro_system_fgms001_motion_sensor_sensor_8_0
      - light.bathroom



# Checks for available updates
updater:

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:

# View all events in a logbook
logbook:

# Track the sun
sun:

netatmo:
  api_key: !secret netatmo_api_key
  secret_key: !secret netatmo_secret_key
  username: !secret netatmo_username
  password: !secret netatmo_password
  
notify:
  - name: email
    platform: smtp
    server: !secret smtp_server
    sender: !secret smtp_sender
    username: !secret smtp_username
    password: !secret smtp_password
    recipient: !secret smtp_recipient


sensor:
  - platform: yr
  - platform: mqtt
    name: "Unit Status"
    state_topic: "unit/status"
  - platform: mqtt
    name: "Unit Temperature"
    state_topic: "unit/temperature"
    unit_of_measurement: "°C"
  - platform: mqtt
    name: "Unit Humidity"
    state_topic: "unit/humidity"
    unit_of_measurement: "%"
    
binary_sensor:
  - platform: template
    sensors:
      unit_online:
        value_template: "{{ states.sensor.unit_status.state == 'online' }}"
        sensor_class: connectivity
        friendly_name: "Unit Status"
        
        
automation: !include_dir_list automation 

#nest:
#  client_id: !secret nest_username
#  client_secret: !secret nest_password


#climate:
#  platform: nest
  
  
zwave:
  usb_path: /dev/zwave


scene:
  - name: Kitchen Fade On
    entities:
      light.kitchen_1:
        state: on
        transition: 1
        brightness: 255
      light.kitchen_2:
        state: on
        transition: 5
        brightness: 255
      light.kitchen_3:
        state: on
        transition: 3
        brightness: 255    
      light.kitchen_4:
        state: on
        transition: 2
        brightness: 255       
     
  - name: Bathroom Middle Of Night
    entities:
      light.bathroom_1:
        state: on
        transition: 10
        brightness: 50
      light.bathroom_2:
        state: on
        transition: 10
        brightness: 50
      light.bathroom_3:
        state: on
        transition: 10
        brightness: 50
      light.bathroom_4:
        state: on
        transition: 10
        brightness: 50
      light.bathroom_5:
        state: on
        transition: 10
        brightness: 50

  - name: Bathroom Normal
    entities:
      light.bathroom_1:
        state: on
        transition: 1
        brightness: 255
      light.bathroom_2:
        state: on
        transition: 2
        brightness: 255
      light.bathroom_3:
        state: on
        transition: 3
        brightness: 255
      light.bathroom_4:
        state: on
        transition: 4
        brightness: 255
      light.bathroom_5:
        state: on
        transition: 5
        brightness: 255



mqtt:
  broker: !secret mqtt_broker
  port: !secret mqtt_port
  username: !secret mqtt_username
  password: !secret mqtt_password
  birth_message:
    topic: 'home/status'
    payload: 'online'
    qos: 1
    retain: true
  will_message:
    topic: 'home/status'
    payload: 'offline'
    qos: 1
    retain: true

alarm_control_panel:
  - platform: manual
    name: Alarm
    code: !secret alarm_control_panel_code
    pending_time: 10
    trigger_time: 10


device_tracker:
  - platform: owntracks
    max_gps_accuracy: 200

zone:
  name: School
  latitude: !secret zone_lat
  longitude: !secret zone_lon
  radius: 200
  icon: mdi:school
zone 2:
  name: Unit
  latitude: !secret zone2_lat
  longitude: !secret zone2_lon
  radius: 100
  icon: mdi:factory
zone 3:
  name: Home
  latitude: !secret zone3_lat
  longitude: !secret zone3_lon
  radius: 100
  icon: mdi:home-variant
 
zone 4:
  name: Castle
  latitude: !secret zone4_lat
  longitude: !secret zone4_lon
  radius: 75
  icon: mdi:beer


# Example configuration.yaml entry
alexa:
  intents:
    WhereAreWeIntent:
      speech:
        type: plaintext
        text: >
          {%- if is_state('device_tracker.roy_thephone', 'home') and
                 is_state('device_tracker.nina_iphone', 'home') -%}
            You are both home, you silly billy
          {%- else -%}
            Roy is at {{ states("device_tracker.roy_thephone") }}
            Nina is at {{ states("device_tracker.nina_iphone") }}
          {% endif %}

    LocateIntent:
#      action:
#        service: notify.notify
#        data_template:
#          message: The location of {{ User }} has been queried via Alexa.
      speech:
        type: plaintext
        text: >
          {%- for state in states.device_tracker -%}
            {%- if state.name.lower() == User.lower() -%}
              {{ state.name }} is at {{ state.state }}
            {%- endif -%}
          {%- else -%}
            I am sorry, I do not know where {{ User }} is.
          {%- endfor -%}
      card:
        type: simple
        title: Sample title
        content: Some more content
